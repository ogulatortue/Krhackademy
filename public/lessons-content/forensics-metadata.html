<section class="content-block">
    <h2><i class="fas fa-info-circle" aria-hidden="true"></i>Généralités sur les métadonnées</h2>
    <p>
        Les métadonnées sont des données qui fournissent des informations sur d'autres données. Elles servent à décrire, structurer et gérer des ressources, qu'elles soient numériques ou physiques. Plutôt que de constituer le contenu principal d'un fichier ou d'un document, les métadonnées en précisent le contexte et les caractéristiques. Elles répondent généralement à des questions telles que : qui a créé la donnée, quand a-t-elle été créée, quel est son format, ou encore quels sont les droits qui y sont associés.
    </p>
    <p>
        Avant de se lancer dans l'analyse, il est impératif de comprendre la nature fondamentale des métadonnées et, surtout, où les chercher. Toute métadonnée appartient à l'une des deux grandes familles, dont la fiabilité et l'origine sont radicalement différentes.
    </p>
    <h3>Métadonnées de système de fichiers (externes)</h3>
    <p>Gérées par le système d'exploitation (Windows, macOS), elles sont stockées à l'extérieur du fichier, dans la "table des matières" du disque (comme la <code>Master File Table</code> ou MFT sur les systèmes NTFS). Elles décrivent le contenant, sa taille, son emplacement et son interaction avec le système.</p>
    <h3>Métadonnées applicatives (internes)</h3>
    <p>Créées par le logiciel qui a fabriqué le fichier (Word, Photoshop, Appareil photo), elles sont stockées à l'intérieur du fichier lui-même, selon les spécifications de son format. Elles décrivent le contenu, son auteur, son contexte de création, etc.</p>
    <p>
        Cette distinction est le concept le plus important de l'analyse. Une incohérence entre ces deux familles est souvent le premier signe d'une manipulation ou d'une anomalie. La comparaison de la date de création interne d'un document avec la date de création de son fichier sur le disque peut, par exemple, révéler une copie ou une falsification.
    </p>
    <p>
        La finalité des métadonnées est donc double. Pour le système, elles sont opérationnelles : elles permettent l'organisation, l'indexation et la gestion des données. Pour un analyste, elles sont historiques et contextuelles : elles fournissent un enregistrement traçable des événements liés à une ressource numérique, ce qui est essentiel en administration système, en sécurité et en analyse forensique.
    </p>
</section>
<section class="content-block">
    <h2><i class="fas fa-clock" aria-hidden="true"></i>Les timestamps MACE</h2>
    <p>
        Les métadonnées les plus fondamentales et les plus universelles sont les timestamps (horodatages) gérés par le système de fichiers. Ils constituent le socle de toute analyse chronologique, permettant de placer les événements sur une ligne de temps précise. On les désigne par l'acronyme <code>MACE</code>.
    </p>
    <ul>
        <li><strong>Modified :</strong> Date et heure de la dernière modification du contenu du fichier.</li>
        <li><strong>Accessed :</strong> Date et heure du dernier accès (ouverture). Attention, ce timestamp est souvent désactivé sur les systèmes modernes pour des raisons de performance.</li>
        <li><strong>Changed :</strong> Date et heure du dernier changement des métadonnées elles-mêmes (ex: changement de nom, de permissions). C'est la date de modification de l'entrée dans la <code>MFT</code>.</li>
        <li><strong>Entry created (ou Birth) :</strong> Date et heure de la création du fichier sur le volume.</li>
    </ul>
    <p>
        <strong>Point d'analyse :</strong> Sur un système de fichiers <code>NTFS</code> (Windows), il existe deux jeux de timestamps MACE :
    </p>
    <ul>
        <li><code>$STANDARD_INFORMATION</code> (visibles dans l'explorateur)</li>
        <li><code>$FILE_NAME</code> (stockés dans la MFT et moins facilement modifiables)</li>
    </ul>
    <p>Un outil de timestomping simple modifiera souvent le premier, mais oubliera le second. Une incohérence entre ces deux jeux de dates est un indice de manipulation quasi certain.</p>
    <h3>Exemple concret</h3>
    <p>Voici comment les timestamps MACE d'un fichier Rapport.docx évoluent au fil de son utilisation. Une telle chronologie peut être reconstituée avec un outil comme <code>MFTECmd</code>.</p>
<pre><code>-- Fichier: Rapport_Final.docx --
ÉVÉNEMENT           | MODIFIED           | ACCESSED           | CHANGED (MFT)      | CREATED (Birth)
--------------------|--------------------|--------------------|--------------------|--------------------
10:00 Création      | 10:00 (Lundi)      | 10:00 (Lundi)      | 10:00 (Lundi)      | 10:00 (Lundi)
10:05 Rédaction     | 10:05 (Lundi)      | 10:05 (Lundi)      | 10:05 (Lundi)      | 10:00 (Lundi)
11:00 Renommage     | 10:05 (Lundi)      | 10:05 (Lundi)      | 11:00 (Lundi)      | 10:00 (Lundi)
09:00 Relecture     | 10:05 (Lundi)      | 09:00 (Mardi)      | 11:00 (Lundi)      | 10:00 (Lundi)</code></pre>
</section>
<section class="content-block">
    <h2><i class="fas fa-cogs" aria-hidden="true"></i>L'analyse applicative</h2>
    <p>
        Si les timestamps MACE nous donnent le "quand", les métadonnées applicatives nous donnent le "qui", le "comment" et le "où". Pour extraire et interpréter ces informations riches, l'outil <code>ExifTool</code> est la référence mondiale.
    </p>
    <h3>1. Les documents Microsoft office (.docx, .pptx, etc.)</h3>
    <p>Bien plus que de simples conteneurs de texte, les fichiers Office modernes sont de véritables journaux de bord.</p>
    <p>Métadonnées clés :</p>
    <ul>
        <li><strong>Creator</strong> (auteur initial)</li>
        <li><strong>Last Modified By</strong> (dernier utilisateur à avoir sauvegardé)</li>
        <li><strong>Total Edit Time</strong> (temps total d'édition)</li>
        <li><strong>Revision Number</strong> (nombre de sauvegardes)</li>
    </ul>
    <h3>2. Les images (.jpg, .heic, .png)</h3>
    <p>Les métadonnées EXIF (Exchangeable Image File Format) peuvent transformer une simple image en une preuve factuelle irréfutable. L'analyse d'une photo de suspect, IMG_4587.jpg, avec ExifTool pourrait révéler :</p>
<pre><code>$ exiftool IMG_4587.jpg
Make                            : Apple
Camera Model Name               : iPhone 14
Software                        : 17.5.1
Date/Time Original              : 26/08/2025 11:00:15
GPS Latitude                    : 44 deg 54' 58.819" N
GPS Longitude                   : 4 deg 54' 46.82" E</code></pre>
    <h3>3. Les fichiers PDF</h3>
    <p>Souvent perçus comme statiques, les PDF conservent des traces de leur cycle de vie.</p>
    <p>Métadonnées clés :</p>
    <ul>
        <li><strong>Author</strong></li>
        <li><strong>CreatorTool</strong> (logiciel ayant produit le contenu)</li>
        <li><strong>Producer</strong> (logiciel ayant converti en PDF)</li>
    </ul>
    <p><strong>Exemple :</strong> Une fausse facture Facture.pdf indique <code>CreatorTool: "Adobe Illustrator 2024"</code>. Une facture est normalement générée par un logiciel de comptabilité, pas un logiciel de design graphique. Cet indice suggère une création de toutes pièces.</p>
    <h3>4. Les fichiers de raccourcis Windows (.lnk)</h3>
    <p>Loin d'être de simples pointeurs, les fichiers .lnk sont des mines d'or forensiques. Ils enregistrent l'état de leur cible au moment de leur création.</p>
    <p>Métadonnées clés :</p>
    <ul>
        <li>Chemin complet du fichier cible (ex: <code>C:\Users\Hugo\Desktop\Liste_Clients.xlsx</code>)</li>
        <li>Ses timestamps MACE d'origine</li>
        <li>Le nom de la machine sur laquelle il était stocké (<code>NetBIOS name</code>)</li>
        <li>L'adresse MAC de la carte réseau de cette machine</li>
    </ul>
</section>
<section class="content-block">
    <h2><i class="fas fa-user-secret" aria-hidden="true"></i>Anti-forensique et analyse critique</h2>
    <p>
        Un expert ne se contente pas de lire les métadonnées ; il évalue leur crédibilité. Savoir reconnaître les techniques d'anti-forensique est une compétence essentielle.
    </p>
    <h3>Le timestomping (falsification des horodatages)</h3>
    <p>C'est l'acte de modifier les timestamps MACE d'un fichier pour dissimuler sa véritable origine, souvent pour cacher un malware en lui donnant l'apparence d'un vieux fichier système légitime.</p>
    <p><strong>Exemple :</strong> L'analyse d'un fichier svchost.exe suspect révèle une incohérence majeure, preuve quasi certaine d'une manipulation. L'horodatage du système de fichiers est comparé à celui présent dans l'en-tête du fichier (<code>PE Header</code>).</p>
<pre><code># Analyse avec un outil forensique
Fichier: C:\Windows\System32\svchost.exe

[Timestamps Système de Fichiers]
Modified     : 2015/05/30 11:25:00
Created      : 2015/05/30 11:25:00

[Timestamp de compilation interne]
PE Header Time : 2024/08/12 22:10:05 <-- INCOHÉRENCE !</code></pre>
    <h3>Le metadata stripping (nettoyage des métadonnées)</h3>
    <p>De nombreuses plateformes en ligne (Facebook, Twitter/X, WhatsApp) suppriment la plupart des métadonnées EXIF des images lors du téléversement pour protéger la vie privée et réduire la taille des fichiers.</p>
    <p><strong>Implication pour l'enquêteur :</strong> L'analyse d'une photo téléchargée depuis un réseau social est souvent inutile. Il est impératif de travailler sur le fichier original provenant de l'appareil source.</p>
</section>
<section class="content-block">
    <h2><i class="fas fa-flag-checkered" aria-hidden="true"></i>Conclusion</h2>
    <p>
        L'analyse des métadonnées est un art qui se situe à la croisée de la technique et de l'enquête. La compétence clé n'est pas seulement de savoir extraire une information, mais de savoir la corréler. C'est en croisant les données du système avec celles des applications, en comparant les timestamps et en questionnant les incohérences que l'analyste transforme des informations éparses en une chronologie cohérente et défendable.
    </p>
    <p>
        Leçon créée par Hugo Bruchon.
    </p>
</section>