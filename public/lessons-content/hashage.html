    <section class="content-block">
        <h2>Introduction et Avertissement</h2>
        <p>
            [cite_start]Ce document a pour but d'expliquer la base des hashs et des méthodes permettant de les craquer ou de les contourner. [cite: 7]
        </p>
        <p>
            [cite_start]<strong>Disclaimer :</strong> Ce document a pour but d'être éducatif et de fournir des bases. [cite: 8] [cite_start]Ce n'est pas une documentation complète, il existe des attaques qui ne sont pas présentées ici et vous êtes invités à faire vos propres recherches. [cite: 9] [cite_start]Le piratage est un délit au regard de la loi et ce document n'est pas un encouragement à la pratique d'activités illégales. [cite: 10]
        </p>
    </section>

    <section class="content-block">
        <h2>Qu'est-ce qu'un hash ?</h2>
        <h3>Mise en contexte</h3>
        <p>
            [cite_start]Lorsque qu'un client souhaite s'authentifier auprès d'un serveur, il lui transmet un mot de passe. [cite: 14] [cite_start]Ce mot de passe, associé à son identifiant, permet de l'identifier et de l'authentifier. [cite: 15] [cite_start]Cependant face à des acteurs malveillants capables d'intercepter les paquets passant sur le réseau, transmettre ce mot de passe sans cryptage représente le risque de voir le mot de passe intercepté et réutilisé à des fins malveillantes. [cite: 16] [cite_start]Mais pour la même raison que transmettre le mot de passe sans cryptage représente un risque, transmettre une clé de chiffrement n'est pas une option puisque celle-ci aussi pourra être interceptée. [cite: 17]
        </p>
        <h3>Les fonctions de hachage cryptographique</h3>
        <p>
            [cite_start]La situation est cependant particulière : le mot de passe est connu du client ET du serveur. [cite: 19] [cite_start]Donc supposons que l'on crypte une donnée, si le serveur et le client cryptent tous les deux, et que le serveur compare les deux données cryptées, le résultat devrait être identique. [cite: 20] [cite_start]C'est pour cela que les fonctions de hachage cryptographique ont été conçues. [cite: 21] [cite_start]Le résultat d'une fonction de hachage peut être appelée empreinte, condensé ou bien hash. [cite: 22] [cite_start]Pour que l'une de ces fonctions soit utilisée elle doit satisfaire quelques propriétés : [cite: 23]
        </p>
        <ul>
            [cite_start]<li><strong>Déterminisme :</strong> f(x)=y pour un x et une fonction donnée (pour la comparaison). [cite: 24]</li>
            [cite_start]<li><strong>Rapide à calculer :</strong> l'exécution de la fonction doit être rapide car elle est souvent utilisée. [cite: 25]</li>
            [cite_start]<li><strong>Non bijective :</strong> On ne doit pas pouvoir trouver x en inversant la fonction à partir de y. [cite: 26]</li>
            [cite_start]<li><strong>Résistant à la falsification/pré-image :</strong> Les mots de passes doivent avoir une empreinte de hash qui change fortement à la plus petite modification. [cite: 27]</li>
            [cite_start]<li><strong>Résistant aux collisions :</strong> Il doit être globalement impossible de trouver deux messages qui produisent le même hash. [cite: 29]</li>
        </ul>
        <h3>Différentes fonctions</h3>
        <p>Il existe différentes fonctions de hachage, cryptographique ou non. [cite_start]Pour les fonctions cryptographiques on pourra par exemple citer : [cite: 32]</p>
         <ul>
            <li><strong>Message Digest 5 (MD5) :</strong> Très utilisé pendant longtemps. [cite_start]Il n'est plus considéré comme sûr suite à la découverte d'une méthode d'attaque par collisions. [cite: 33]</li>
            [cite_start]<li><strong>Secure Hash Algorithm (SHA) :</strong> Il existe beaucoup de variantes utilisées de celui-ci. [cite: 34] [cite_start]Une attaque par collision a été effectuée contre SHA-1. [cite: 35] [cite_start]Un format courant est SHA2-256. [cite: 35]</li>
            [cite_start]<li><strong>Whirlpool :</strong> Ce format a été conçu de façon similaire à AES, ce qui garantit une haute fiabilité et une grande robustesse. [cite: 36] [cite_start]Il génère des empreintes de 512 bits, ce qui est pour le moment assez rare. [cite: 37]</li>
            [cite_start]<li><strong>Construction de Merkle Damgård :</strong> Cette construction utilise des méthodes de compression et de division par blocs pour permettre de créer une sortie de taille fixe avec une entrée de taille quelconque. [cite: 38] [cite_start]Les formats MD5 et SHA-1 entre autre reposent sur cette construction. [cite: 39] [cite_start]Cependant cette construction présente d'importants problèmes. [cite: 40]</li>
        </ul>
    </section>

    <section class="content-block">
        <h2>Les attaques</h2>
        <h3>Pass the Hash</h3>
        <p>
            [cite_start]Cette attaque repose sur une question : Qu'est ce qui prouve que le client a bien calculé le hash ? [cite: 45] Qu'est ce qui prouve que le "client" n'est pas un acteur malveillant qui a intercepté le hash et l'envoie sans rien avoir calculé ? [cite_start]La réponse est rien. [cite: 46, 47] [cite_start]Si des sécurités comme la concaténation d'une donnée aléatoire au mot de passe ou l'authentification à deux facteurs ne sont pas mises en place, il est possible d'utiliser l'empreinte en tant que mot de passe. [cite: 47, 48]
        </p>
        <h3>Bruteforce</h3>
        <p>
            [cite_start]Les attaques par force brute consistent à essayer chaque entrée possible jusqu'à trouver la bonne. [cite: 50] [cite_start]Pour rendre cette attaque réaliste, il faut utiliser des masques, qui peuvent être vus comme le "modèle" du mot de passe. [cite: 52, 53] [cite_start]Ils permettent d'indiquer des types de caractères et leur emplacement afin de restreindre l'étendue des recherches. [cite: 53, 54]
        </p>
        <h3>Wordlist</h3>
        <p>
            [cite_start]Les attaques par dictionnaires reposent principalement sur des brèches de données où les mots de passe des utilisateurs ont fuité. [cite: 58] [cite_start]À partir de ces listes, on peut constituer des dictionnaires de mots de passe à essayer les uns après les autres. [cite: 59] [cite_start]Cette attaque est extrêmement efficace car beaucoup de mots de passes sont courants et réutilisés. [cite: 60]
        </p>
        <h3>Rules</h3>
        <p>
            [cite_start]Les "rules" sont un complément des attaques par dictionnaires. [cite: 67] [cite_start]Elles agissent comme un "langage de programmation" qui permet de générer des candidats supplémentaires à partir des mots d'un dictionnaire. [cite: 67] [cite_start]Par exemple, pour un mot de passe comme <code>xXCoucou_26Xx</code> qui ne peut pas être facilement craqué avec une attaque par dictionnaire classique, les rules permettent de générer des variations en ajoutant des préfixes, des suffixes ou en remplaçant des caractères. [cite: 69, 71]
        </p>
         <h3>Collisions</h3>
        <p>
            [cite_start]Une collision désigne une situation dans laquelle deux données différentes ont un résultat identique avec la même fonction de hachage. [cite: 77] [cite_start]Les attaques par collisions consistent à essayer de trouver deux messages M1 et M2 qui possèdent la même valeur de hachage. [cite: 82] [cite_start]Cette méthode a entre autre permis de forger des certificats de signatures permettant d'usurper des autorités de certification de site. [cite: 86]
        </p>
        <h3>Extension de longueur</h3>
        <p>
           [cite_start]Cette attaque est spécifique et ne fonctionne que si une fonction de hachage suivant la construction de Merkle-Damgård est utilisée comme code d'authentification, et que le message haché est de la forme (salt + message). [cite: 89, 90, 91] [cite_start]Si toutes ces conditions sont réunies, il est possible d'étendre le contenu du message sans connaître le "salt" (un ensemble de bytes aléatoires ajoutés au message avant le hachage). [cite: 92, 94]
        </p>
        <h3>Outils</h3>
        <p>
            Il existe plusieurs logiciels permettant de craquer des hashs :
        </p>
        <ul>
            [cite_start]<li><strong>Hashcat :</strong> Connu pour son optimisation et sa capacité à utiliser le GPU pour accélérer la vitesse des essais. [cite: 99] [cite_start]Il supporte tous les types d'attaques mentionnés dans ce document. [cite: 100]</li>
            [cite_start]<li><strong>John the Ripper :</strong> Dans sa version standard, il identifie seul les hashs et les craque efficacement. [cite: 103] [cite_start]Une version communautaire "Jumbo" supporte beaucoup plus de formats de hashs. [cite: 107]</li>
            [cite_start]<li><strong>Hashid :</strong> Cet outil ne permet pas de craquer des hashs, mais seulement d'identifier le type de hash. [cite: 110]</li>
        </ul>
    </section>

    <section class="content-block">
        <h2>Les parades</h2>
        <h3>Sécurité des mots de passes</h3>
        <p>
            [cite_start]Certaines de ces attaques reposent sur l'exploitation de failles connues, ce qui nécessite de se maintenir au courant de l'actualité de la cybersécurité. [cite: 127] [cite_start]Les autres attaques exploitent la faiblesse des mots de passes utilisateurs. [cite: 128]
        </p>
        <h3>Recommandations</h3>
        <p>
            [cite_start]Pour la sécurité des mots de passes, les recommandations générales sont des mots de passes complexes, utilisant des chiffres, minuscules, majuscules et caractères spéciaux, d'une longueur d'au moins 12 caractères. [cite: 131] [cite_start]Ceci doit être accompagné de système de blocage strict (par exemple, 10 essais avant un blocage nécessitant une intervention de l'utilisateur). [cite: 131, 133] [cite_start]Pour se prémunir de l'attaque par extension de longueur, il suffit d'utiliser des fonctions dites "HMAC", ne suivant pas la construction de Merkle-Damgård, comme HMAC-SHA-256. [cite: 129, 130]
        </p>
        <p>
            [cite_start]Pour plus d'informations, vous pouvez consulter la page de la CNIL : <a href="https://www.cnil.fr/fr/mots-de-passe-une-nouvelle-recommandation-pour-maitriser-sa-securite" target="_blank">https://www.cnil.fr/fr/mots-de-passe-une-nouvelle-recommandation-pour-maitriser-sa-securite</a> [cite: 135]
        </p>
    </section>

    <nav class="content-navigation">
        <a href="#" class="nav-button">Retour aux leçons</a>
        <a href="#" class="nav-button">Valider la leçon</a>
    </nav>
