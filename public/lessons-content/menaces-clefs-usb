<section class="content-block">
    <h2><i class="fas fa-industry" aria-hidden="true"></i>La cybersécurité et l'industrie</h2>
    <p>
        La « cybersécurité », « sécurité des systèmes d'information » (SSI) ou plus simplement « sécurité informatique » désigne l'ensemble des moyens permettant de protéger un système d'information: Mécanismes et outils techniques (pare-feu, antivirus, chiffrement, ...), Moyens organisationnels, Procédures (sauvegardes, ...), Lois.
    </p>
    <p>
        Une « cyber-attaque » est une atteinte à un système informatique réalisée dans un but malveillant. Il existe différents types de risques cyber affectant les particuliers, les administrations et les entreprises: Espionnage, Sabotage, Rançonnage, Atteinte à l'image, Cryptojacking.
    </p>
    <p>
        La cybersécurité complète la sécurité physique. La sécurité physique vise traditionnellement à empêcher les accès physiques non autorisés avec des Murs épais, Portes sécurisées, Clôtures, Agents de sécurité, Vidéo protection, Alarmes.
    </p>
    <p>
        Pendant longtemps, ces seules mesures de sécurité physique ont suffi à protéger les installations industrielles, et notamment les installations de production, transport et distribution d'électricité. Les pirates informatiques ne s'intéressaient guère aux systèmes industriels qu'ils ne comprenaient pas. Par ailleurs, ces systèmes industriels n'étaient pas accessibles de l'extérieur. Les entreprises étaient éventuellement victimes d'espionnage industriel, mais c'était le réseau de l'informatique bureautique qui était attaqué.
    </p>
    <p>
        Aujourd'hui, l'industrie s'est grandement informatisée et robotisée (OT: Operational Technology). Afin d'offrir de nouveaux services autant aux clients qu'aux opérateurs des installations industrielles, les systèmes sont maintenant interconnectés. Les industries sont exposées aux risques de cybersécurité et aux attaques préméditées ou opportunistes.
    </p>
</section>

<section class="content-block">
    <h2><i class="fas fa-book-reader" aria-hidden="true"></i>La norme IEC 62443</h2>
    <p>
        IEC 62443 : norme sur la cybersécurité des systèmes industriels.
    </p>
    <p>
        IEC 62443-3-3: segmentation des réseaux, défense en profondeur. Modèle également connu sous le nom: ISA-99 / Purdue Reference Model.
    </p>
    <h3>Les data diodes</h3>
    <p>
        Une passerelle unidirectionnelle ou data diode est un périphérique réseau qui permet aux données de circuler dans une seule direction. Les data diodes se trouvent le plus souvent dans les environnements de haute sécurité. Elles servent de connexions entre deux réseaux de classifications de sécurité différentes.
    </p>
</section>

<section class="content-block">
    <h2><i class="fas fa-usb" aria-hidden="true"></i>Les menaces USB</h2>
    <p>
        Des attaques opportunistes ou savamment planifiées peuvent s'appuyer sur des périphériques USB pour contourner les équipements de sécurité du réseau (pare-feu, NIDS, ...). Un opérateur peut transporter et exécuter, à son insu, un programme malveillant. Une personne malveillante, disposant d'un accès physique même temporaire, peut déposer un malware voire installer un système de prise de contrôle à distance. Les périphériques USB peuvent devenir des menaces majeures en cas de sensibilisation insuffisante du personnel, particulièrement en l'absence de mise à jour du système ou en l'absence de moyen de détection.
    </p>
    <h3>Les différents types de périphériques USB</h3>
    <p>
        L'universalité du bus USB permet la connexion de différents types de périphériques : « Communications » (modem, adaptateur Ethernet, ...), « Human interface device » (clavier, souris, ...), « Image » (scanner, appareil photo, ...), « Printer », « Mass storage » (clé USB, ...), « USB hub », « Smart Card », « Content security » (lecteur d'empreintes, ...), « Video » (webcam, ...), etc... Un même périphérique peut intégrer un hub + un stockage de masse + une interface réseau. Exemple: smartphone.
    </p>
    <p>
        Avec la disparation des claviers et souris PS/2, les ports USB ne peuvent pas être entièrement désactivés. Les périphériques USB de communication, d'interface utilisateur, de stockage peuvent transporter et/ou exécuter des programmes malveillants. Sur un système durci, hors opération de maintenance, les périphériques de stockage de masse (clés USB) sont généralement bloqués, mais...
    </p>
    <h3>Les menaces USB: les périphériques d'interface utilisateur</h3>
    <p>
        Un système d'exploitation accepte en toute confiance claviers et souris USB (HID). Il est possible d'émuler un clavier et d'envoyer des instructions préprogrammées depuis un périphérique USB ayant l'apparence d'une clé USB. Exemple : « Rubber Ducky ». Un utilisateur bien intentionné peut être manipulé pour insérer ce qu'il croit être une clé USB inoffensive. Sur un système durci, même sans accès direct à la machine, un utilisateur malveillant peut aisément ouvrir la souris ou le clavier USB et récupérer une connectique.
    </p>
    <h3>Les menaces USB: les périphériques de communication</h3>
    <p>
        Les périphériques de communication sont souvent automatiquement reconnus. Un périphérique de communication peut établir une liaison vers Internet sans passer par le réseau de l'entreprise. Exemple: smartphone avec liaison 4G/5G. Permet d'échapper aux moyens de détection du réseau de l'entreprise. Permet d'établir un canal vers un centre de contrôle et commande distant. Nous sommes certainement nombreux à recharger notre smartphone sur notre PC. L'utilisation d'un « data blocker » est fortement recommandée.
    </p>
    <h3>Face aux menaces USB</h3>
    <p>
        La sensibilisation des utilisateurs reste primordiale. Des moyens de détection des menaces sont nécessaires. Une surveillance active (humaine) est recommandée en complément des moyens d'alerte passifs. La défense en profondeur doit être complétée par : une centralisation des logs, un Maintien en Conditions de Sécurité et une surveillance des vulnérabilités.
    </p>
</section>

<section class="content-block">
    <h2><i class="fas fa-laptop-code" aria-hidden="true"></i>Exercices</h2>

    <h3>Exercice 1 : Identifier les périphériques USB</h3>
    <p>
        Comment identifier les périphériques USB de sa machine? Quels sont les périphériques connectés?
    </p>
    <p><strong>Solution :</strong></p>
    <pre style="background-color:#eee; border-radius:5px; padding:10px; font-family:monospace;"><code>lsusb
sudo apt update
sudo apt install xinput
xinput list</code></pre>

    <hr style="margin: 20px 0;">

    <h3>Exercice 2 : Le langage « Ducky Script » - Premier script</h3>
    <p>
        Ecrire et exécuter son premier script Ducky (fichier ducky001.txt à créer).
        <br>• Ouvrir un terminal Shell et lancer une commande basique à l’aide d’un script Ducky.
    </p>
    <p><strong>Prérequis :</strong></p>
    <pre style="background-color:#eee; border-radius:5px; padding:10px; font-family:monospace;"><code>cd
python3 -m venv venvducky
venvducky/bin/pip install pyautogui
git clone https://github.com/0ent/ducky2python
vi ducky001.txt
venvducky/bin/python ducky2python/ducky2python.py ducky001.txt</code></pre>
    <p><strong>Solution (contenu de ducky001.txt) :</strong></p>
    <pre style="background-color:#eee; border-radius:5px; padding:10px; font-family:monospace;"><code>DELAY 1000
ALT F2
DELAY 3000
STRING qterminal
DELAY 300
ENTER
DELAY 1000
STRING ls
DELAY 100
ENTER</code></pre>
    <p><em>Note : Utilisez GUI r au lieu de ALT F2 en fonction de votre distribution.</em></p>

    <hr style="margin: 20px 0;">

    <h3>Exercice 3 : Protéger l’exécution du script Ducky</h3>
    <p>
        Bloquer temporairement le clavier et la souris de l’utilisateur.
    </p>
    <p><strong>Solution :</strong></p>
    <p><em>Les identifiants du clavier (ex: 10) et de la souris (ex: 8) s’obtiennent grâce à une phase de reconnaissance préalable (cf. exercice 1).</em></p>
    <pre style="background-color:#eee; border-radius:5px; padding:10px; font-family:monospace;"><code>DELAY 4000
ALT F2
DELAY 300
STRING qterminal
DELAY 100
ENTER
DELAY 1000
STRING xinput set-int-prop 10 "Device Enabled" 8 0
DELAY 100
ENTER
DELAY 200
STRING xinput set-int-prop 8 "Device Enabled" 8 0
DELAY 100
ENTER</code></pre>

    <hr style="margin: 20px 0;">

    <h3>Exercice 4 : USBGuard</h3>
    <p>
        Installer et configurer USBGuard.
    </p>
    <p><strong>Solution :</strong></p>
    <pre style="background-color:#eee; border-radius:5px; padding:10px; font-family:monospace;"><code>sudo apt install usbguard
sudo usbguard generate-policy > /etc/usbguard/rules.conf
sudo systemctl enable --now usbguard
sudo usbguard list-devices
sudo usbguard allow-device xxx</code></pre>
    
    <hr style="margin: 20px 0;">

    <h3>Références</h3>
    <ul>
        <li><a href="https://shop.hak5.org/products/usb-rubber-ducky" target="_blank">https://shop.hak5.org/products/usb-rubber-ducky</a></li>
        <li><a href="https://payloadstudio.hak5.org/community/" target="_blank">https://payloadstudio.hak5.org/community/</a></li>
        <li><a href="https://github.com/taibhse-designs/DuckyEmulator" target="_blank">https://github.com/taibhse-designs/DuckyEmulator</a></li>
        <li><a href="https://fr.wikipedia.org/wiki/Fichier_de_test_Eicar" target="_blank">https://fr.wikipedia.org/wiki/Fichier_de_test_Eicar</a></li>
    </ul>
</section>


<section class="content-block">
    <h2><i class="fas fa-info-circle" aria-hidden="true"></i>Informations sur le document original</h2>
    <p>
        <b>Titre :</b> L'énergie face aux risques de cybersécurité<br>
        <b>Auteurs :</b> Eduardo Navarro Tarján, Sébastien Blanc, EVIDEN<br>
        <b>Date de publication :<br> 11/04/2024
        <b>Contact :</b> eduardo.navarrotarjan@eviden.com / sebastien.blanc@eviden.com<br>
    </p>
</section>

<nav class="content-navigation">
    <a href="./lessons.php" class="nav-button prev-button"><i class="fas fa-arrow-left" aria-hidden="true"></i> Retour aux leçons</a>
    <a href="./lessons.php" class="nav-button next-button">Valider la leçon <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav>
