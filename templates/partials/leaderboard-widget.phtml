<section class="widget-panel leaderboard-panel" id="leaderboard-menu" aria-hidden="true">
    <div class="leaderboard-header">
        <i class="fas fa-trophy panel-icon"></i>
        <span>Classement</span>
        <button id="close-leaderboard-btn" class="fas fa-times" aria-label="Fermer le classement"></button>
    </div>
    <div class="leaderboard-content">
        <ul class="leaderboard-list">
            <?php foreach ($leaderboardWidgetData['topUsers'] as $index => $user): ?>
                <?php
                    $podiumClass = 'podium-' . ($index + 1);
                    $isCurrentUser = ($_SESSION['user_id'] ?? null) == $user['id'];
                    $highlightClass = $isCurrentUser ? ' current-user-podium-border' : '';
                ?>
                <li class="leaderboard-item <?= $podiumClass . $highlightClass ?>">
                    <span class="rank">#<?= $index + 1 ?></span>
                    <img src="<?= htmlspecialchars($user['avatar_url'] ?? '/images/default-avatar.webp') ?>" alt="Avatar" class="leaderboard-avatar">
                    <span class="username"><?= htmlspecialchars($user['username']) ?></span>
                    <span class="score"><?= $user['score'] ?> <i class="fas fa-flag"></i></span>
                </li>
            <?php endforeach; ?>
            <?php if ($leaderboardWidgetData['currentUser'] && !$leaderboardWidgetData['isCurrentUserInTop3']): ?>
                <li class="leaderboard-separator"></li>
                <li class="leaderboard-item current-user">
                    <span class="rank">#<?= $leaderboardWidgetData['currentUser']['rank'] ?></span>
                    <img src="<?= htmlspecialchars($leaderboardWidgetData['currentUser']['avatar_url'] ?? '/images/default-avatar.webp') ?>" alt="Votre avatar" class="leaderboard-avatar">
                    <span class="username"><?= htmlspecialchars($leaderboardWidgetData['currentUser']['username']) ?></span>
                    <span class="score"><?= $leaderboardWidgetData['currentUser']['score'] ?> <i class="fas fa-flag"></i></span>
                </li>
            <?php endif; ?>
        </ul>
    </div>
    <ul class="leaderboard-options">
        <li><a href="/leaderboard"><i class="fas fa-arrow-right"></i> Classement complet</a></li>
    </ul>
</section>